# Session management for Tor-friendly rate limiting
# This snippet sets a session ID cookie for clients without one

# Only set session ID cookie if client doesn't have one
if ($cookie_session_id = "") {
    add_header Set-Cookie "session_id=$request_id; Path=/; HttpOnly; SameSite=Lax; Max-Age=86400" always;
}
