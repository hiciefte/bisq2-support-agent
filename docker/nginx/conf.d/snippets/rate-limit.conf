# Rate limiting configuration

# Rate limiting zones
limit_req_zone $binary_remote_addr zone=api:10m rate=5r/s;
limit_req_zone $binary_remote_addr zone=admin:10m rate=3r/s;
limit_req_zone $binary_remote_addr zone=grafana:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=web:10m rate=20r/s;
limit_req_zone $binary_remote_addr zone=static:10m rate=30r/s;
limit_req_status 429;

# Connection limiting zone
limit_conn_zone $binary_remote_addr zone=addr:10m;

# Rate limiting rules
limit_req zone=api burst=5 nodelay;
limit_req zone=admin burst=3 nodelay;
limit_req zone=grafana burst=10 nodelay;
limit_req zone=web burst=20 nodelay;
limit_req zone=static burst=30 nodelay;

# Connection limits
limit_conn addr 10; 